<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Enviar Fotos ‚Äî Portal de Obras</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body data-page="upload">

  <!-- ‚îÄ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <header class="header">
    <div class="header-inner">
      <a class="logo" href="index.html">
        <div class="logo-icon">üèóÔ∏è</div>
        <div class="logo-info">
          <span class="logo-text">Portal de Obras</span>
          <span class="logo-sub">Envio de Fotos</span>
        </div>
      </a>
      <nav class="header-nav">
        <a href="index.html" class="btn btn-ghost">‚Üê Dashboard</a>
        <button id="btnSettings" class="btn btn-white">‚öô Configura√ß√µes</button>
      </nav>
    </div>
  </header>

  <!-- ‚îÄ‚îÄ‚îÄ HERO ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <section class="hero">
    <div class="hero-inner">
      <div class="hero-left">
        <h1 class="hero-title">Envio de Fotos da Obra</h1>
        <p class="hero-sub">Selecione a obra, adicione a foto de capa e as fotos de andamento</p>
      </div>
    </div>
  </section>

  <!-- ‚îÄ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <main class="main">

    <!-- Aviso se n√£o configurado -->
    <div id="uploadConfigWarn" style="display:none; margin-bottom:1.25rem">
      <div class="config-status warn">
        ‚ö†Ô∏è &nbsp;Reposit√≥rio GitHub n√£o configurado.
        <button onclick="document.getElementById('btnSettings').click()"
          style="margin-left:8px;background:none;border:none;color:#c2410c;font-weight:700;cursor:pointer;text-decoration:underline">
          Configurar agora
        </button>
      </div>
    </div>

    <form id="uploadForm">
      <div class="upload-layout">

        <!-- ‚îÄ‚îÄ‚îÄ SIDEBAR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <aside class="sidebar-card">
          <div class="sidebar-card-title">üèóÔ∏è Selecionar Obra</div>

          <div class="form-group">
            <label class="form-label" for="obraSelect">Obra</label>
            <select class="form-input" id="obraSelect">
              <option value="">‚Äî Selecione a obra ‚Äî</option>
            </select>
          </div>

          <div id="selectedObraName"
            style="font-size:.82rem;color:#1a4a8a;font-weight:600;min-height:20px;margin-bottom:1.25rem;padding:.5rem .75rem;background:#eff6ff;border-radius:8px;display:none">
          </div>

          <hr style="border:none;border-top:1px solid #e0eaf5;margin:1rem 0">

          <div style="font-size:.78rem;color:#5a7fa8;line-height:1.6">
            <p style="font-weight:700;color:#0d2d5e;margin-bottom:.5rem">üìã Regras de envio:</p>
            <p>‚Ä¢ <strong>1 foto de capa</strong> por obra</p>
            <p>‚Ä¢ At√© <strong>18 fotos</strong> de andamento</p>
            <p>‚Ä¢ Formatos: JPG, PNG, WEBP</p>
            <p>‚Ä¢ Tamanho m√°x: 25 MB por foto</p>
          </div>

          <hr style="border:none;border-top:1px solid #e0eaf5;margin:1rem 0">

          <button type="submit" class="btn btn-primary btn-lg" id="submitBtn"
            style="width:100%;justify-content:center">
            üöÄ Enviar Imagens
          </button>

          <!-- Barra de progresso -->
          <div class="upload-progress" id="uploadProgress">
            <div class="progress-bar">
              <div class="progress-fill" id="progressFill" style="width:0%"></div>
            </div>
            <div class="progress-text" id="progressText">Iniciando...</div>
          </div>

        </aside>

        <!-- ‚îÄ‚îÄ‚îÄ √ÅREA PRINCIPAL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <div class="upload-stack">

          <!-- CAPA -->
          <div class="upload-card">
            <div class="upload-card-title">
              üñºÔ∏è Foto de Capa
              <small>1 imagem ‚Äî destaque da obra</small>
            </div>

            <div class="dropzone" id="capaDrop">
              <input type="file" id="capaInput" accept="image/jpeg,image/png,image/webp">
              <div class="dropzone-icon">üñºÔ∏è</div>
              <div class="dropzone-text">
                <strong>Clique aqui</strong> ou arraste a foto de capa
              </div>
              <div class="dropzone-formats">JPG ¬∑ PNG ¬∑ WEBP</div>
            </div>

            <div class="preview-single" id="capaPreview" style="display:none">
              <!-- Preview injetado pelo JS -->
            </div>
          </div>

          <!-- ANDAMENTO -->
          <div class="upload-card">
            <div class="upload-card-title">
              üì∑ Fotos de Andamento
              <small id="progCount">0 / 18 selecionadas</small>
            </div>

            <div class="dropzone" id="progDrop">
              <input type="file" id="progInput" accept="image/jpeg,image/png,image/webp" multiple>
              <div class="dropzone-icon">üì∑</div>
              <div class="dropzone-text">
                <strong>Clique aqui</strong> ou arraste as fotos de andamento
              </div>
              <div class="dropzone-formats">
                Selecione at√© 18 fotos &nbsp;¬∑&nbsp; JPG ¬∑ PNG ¬∑ WEBP
              </div>
            </div>

            <div class="preview-grid" id="progPreview">
              <!-- Previews injetados pelo JS -->
            </div>
          </div>

        </div>
        <!-- fim upload-stack -->

      </div>
      <!-- fim upload-layout -->
    </form>

  </main>

  <!-- ‚îÄ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <footer class="footer">
    Portal de Imagens de Obras &nbsp;¬∑&nbsp; √Årea de Envio
  </footer>

  <!-- ‚îÄ‚îÄ‚îÄ MODAL DE CONFIGURA√á√ïES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="modal-overlay" id="settingsModal">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title">‚öô Configura√ß√£o do Reposit√≥rio GitHub</div>
        <button class="modal-close" id="closeSettings">‚úï</button>
      </div>
      <div id="cfgStatus" class="config-status warn">
        ‚ö†Ô∏è &nbsp;Configure o reposit√≥rio GitHub para habilitar uploads
      </div>
      <form id="settingsForm">
        <div class="form-group">
          <label class="form-label" for="inOwner">Usu√°rio ou Organiza√ß√£o GitHub</label>
          <input class="form-input" id="inOwner" type="text" placeholder="ex: minha-empresa" autocomplete="off">
        </div>
        <div class="form-group">
          <label class="form-label" for="inRepo">Nome do Reposit√≥rio</label>
          <input class="form-input" id="inRepo" type="text" placeholder="ex: portal-obras-imagens" autocomplete="off">
        </div>
        <div class="form-group">
          <label class="form-label" for="inToken">
            Token de Acesso Pessoal (PAT)
            <span> ‚Äî necess√°rio para uploads</span>
          </label>
          <input class="form-input" id="inToken" type="password" placeholder="ghp_xxxxxxxxxxxxxxxxxxxx" autocomplete="off">
          <div class="form-hint">
            Gere em: GitHub ‚Üí Settings ‚Üí Developer settings ‚Üí Personal access tokens<br>
            Permiss√£o necess√°ria: <strong>Contents: Read &amp; Write</strong>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label" for="inBranch">Branch <span>(padr√£o: main)</span></label>
          <input class="form-input" id="inBranch" type="text" placeholder="main" value="main">
        </div>
        <div class="form-actions">
          <button type="button" class="btn" style="background:#f1f5f9;color:#555"
            onclick="document.getElementById('settingsModal').classList.remove('open')">Cancelar</button>
          <button type="submit" class="btn btn-primary">Salvar e Verificar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- ‚îÄ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="toast" id="toast"></div>

  <!-- ‚îÄ‚îÄ‚îÄ SCRIPTS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <script src="js/config.js"></script>
  <script src="js/github-api.js"></script>
  <script src="js/app.js"></script>
  <script>
    // Mostrar nome da obra selecionada no sidebar
    document.addEventListener('DOMContentLoaded', () => {
      const sel  = document.getElementById('obraSelect');
      const name = document.getElementById('selectedObraName');
      if (!sel || !name) return;
      sel.addEventListener('change', () => {
        if (sel.value) {
          name.style.display = '';
        } else {
          name.style.display = 'none';
        }
      });
    });
  </script>

</body>
</html>
